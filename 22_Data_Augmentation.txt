# 데이터 준비
from google.colab import files

my_data = 'colab_train_test.zip'
!unzip colab_train_test.zip

colab_train_test.zip
colab_train_test.zip(application/x-zip-compressed) - 2178812 bytes, last modified: 2021. 4. 13. - 100% done
Saving colab_train_test.zip to colab_train_test.zip
Archive:  colab_train_test.zip
   creating: test/ad/
  inflating: test/ad/ad_test_1.jpg   
  inflating: test/ad/ad_test_10.jpg  
  inflating: test/ad/ad_test_11.jpg  
  inflating: test/ad/ad_test_12.jpg  
  inflating: test/ad/ad_test_13.jpg  
  inflating: test/ad/ad_test_14.jpg  
  inflating: test/ad/ad_test_15.jpg  
  inflating: test/ad/ad_test_16.jpg  
  inflating: test/ad/ad_test_17.jpg  
  inflating: test/ad/ad_test_18.jpg  
  inflating: test/ad/ad_test_19.jpg  
  inflating: test/ad/ad_test_2.jpg   
  inflating: test/ad/ad_test_20.jpg  
  inflating: test/ad/ad_test_21.jpg  
  inflating: test/ad/ad_test_22.jpg  
  inflating: test/ad/ad_test_23.jpg  
  inflating: test/ad/ad_test_24.jpg  
  inflating: test/ad/ad_test_25.jpg  
  inflating: test/ad/ad_test_26.jpg  
  inflating: test/ad/ad_test_27.jpg  
  inflating: test/ad/ad_test_28.jpg  
  inflating: test/ad/ad_test_29.jpg  
  inflating: test/ad/ad_test_3.jpg   
  inflating: test/ad/ad_test_30.jpg  
  inflating: test/ad/ad_test_31.jpg  
  inflating: test/ad/ad_test_32.jpg  
  inflating: test/ad/ad_test_33.jpg  
  inflating: test/ad/ad_test_34.jpg  
  inflating: test/ad/ad_test_35.jpg  
  inflating: test/ad/ad_test_36.jpg  
  inflating: test/ad/ad_test_37.jpg  
  inflating: test/ad/ad_test_38.jpg  
  inflating: test/ad/ad_test_39.jpg  
  inflating: test/ad/ad_test_4.jpg   
  inflating: test/ad/ad_test_40.jpg  
  inflating: test/ad/ad_test_41.jpg  
  inflating: test/ad/ad_test_42.jpg  
  inflating: test/ad/ad_test_43.jpg  
  inflating: test/ad/ad_test_44.jpg  
  inflating: test/ad/ad_test_45.jpg  
  inflating: test/ad/ad_test_46.jpg  
  inflating: test/ad/ad_test_47.jpg  
  inflating: test/ad/ad_test_48.jpg  
  inflating: test/ad/ad_test_49.jpg  
  inflating: test/ad/ad_test_5.jpg   
  inflating: test/ad/ad_test_50.jpg  
  inflating: test/ad/ad_test_51.jpg  
  inflating: test/ad/ad_test_52.jpg  
  inflating: test/ad/ad_test_53.jpg  
  inflating: test/ad/ad_test_54.jpg  
  inflating: test/ad/ad_test_55.jpg  
  inflating: test/ad/ad_test_56.jpg  
  inflating: test/ad/ad_test_57.jpg  
  inflating: test/ad/ad_test_58.jpg  
  inflating: test/ad/ad_test_59.jpg  
  inflating: test/ad/ad_test_6.jpg   
  inflating: test/ad/ad_test_60.jpg  
  inflating: test/ad/ad_test_7.jpg   
  inflating: test/ad/ad_test_8.jpg   
  inflating: test/ad/ad_test_9.jpg   
   creating: test/normal/
  inflating: test/normal/normal_test_1.jpg  
  inflating: test/normal/normal_test_10.jpg  
  inflating: test/normal/normal_test_11.jpg  
  inflating: test/normal/normal_test_12.jpg  
  inflating: test/normal/normal_test_13.jpg  
  inflating: test/normal/normal_test_14.jpg  
  inflating: test/normal/normal_test_15.jpg  
  inflating: test/normal/normal_test_16.jpg  
  inflating: test/normal/normal_test_17.jpg  
  inflating: test/normal/normal_test_18.jpg  
  inflating: test/normal/normal_test_19.jpg  
  inflating: test/normal/normal_test_2.jpg  
  inflating: test/normal/normal_test_20.jpg  
  inflating: test/normal/normal_test_21.jpg  
  inflating: test/normal/normal_test_22.jpg  
  inflating: test/normal/normal_test_23.jpg  
  inflating: test/normal/normal_test_24.jpg  
  inflating: test/normal/normal_test_25.jpg  
  inflating: test/normal/normal_test_26.jpg  
  inflating: test/normal/normal_test_27.jpg  
  inflating: test/normal/normal_test_28.jpg  
  inflating: test/normal/normal_test_29.jpg  
  inflating: test/normal/normal_test_3.jpg  
  inflating: test/normal/normal_test_30.jpg  
  inflating: test/normal/normal_test_31.jpg  
  inflating: test/normal/normal_test_32.jpg  
  inflating: test/normal/normal_test_33.jpg  
  inflating: test/normal/normal_test_34.jpg  
  inflating: test/normal/normal_test_35.jpg  
  inflating: test/normal/normal_test_36.jpg  
  inflating: test/normal/normal_test_37.jpg  
  inflating: test/normal/normal_test_38.jpg  
  inflating: test/normal/normal_test_39.jpg  
  inflating: test/normal/normal_test_4.jpg  
  inflating: test/normal/normal_test_40.jpg  
  inflating: test/normal/normal_test_41.jpg  
  inflating: test/normal/normal_test_42.jpg  
  inflating: test/normal/normal_test_43.jpg  
  inflating: test/normal/normal_test_44.jpg  
  inflating: test/normal/normal_test_45.jpg  
  inflating: test/normal/normal_test_46.jpg  
  inflating: test/normal/normal_test_47.jpg  
  inflating: test/normal/normal_test_48.jpg  
  inflating: test/normal/normal_test_49.jpg  
  inflating: test/normal/normal_test_5.jpg  
  inflating: test/normal/normal_test_50.jpg  
  inflating: test/normal/normal_test_51.jpg  
  inflating: test/normal/normal_test_52.jpg  
  inflating: test/normal/normal_test_53.jpg  
  inflating: test/normal/normal_test_54.jpg  
  inflating: test/normal/normal_test_55.jpg  
  inflating: test/normal/normal_test_56.jpg  
  inflating: test/normal/normal_test_57.jpg  
  inflating: test/normal/normal_test_58.jpg  
  inflating: test/normal/normal_test_59.jpg  
  inflating: test/normal/normal_test_6.jpg  
  inflating: test/normal/normal_test_60.jpg  
  inflating: test/normal/normal_test_7.jpg  
  inflating: test/normal/normal_test_8.jpg  
  inflating: test/normal/normal_test_9.jpg  
   creating: train/ad/
  inflating: train/ad/ad_train_1.jpg  
  inflating: train/ad/ad_train_10.jpg  
  inflating: train/ad/ad_train_11.jpg  
  inflating: train/ad/ad_train_12.jpg  
  inflating: train/ad/ad_train_13.jpg  
  inflating: train/ad/ad_train_14.jpg  
  inflating: train/ad/ad_train_15.jpg  
  inflating: train/ad/ad_train_16.jpg  
  inflating: train/ad/ad_train_17.jpg  
  inflating: train/ad/ad_train_18.jpg  
  inflating: train/ad/ad_train_19.jpg  
  inflating: train/ad/ad_train_2.jpg  
  inflating: train/ad/ad_train_20.jpg  
  inflating: train/ad/ad_train_21.jpg  
  inflating: train/ad/ad_train_22.jpg  
  inflating: train/ad/ad_train_23.jpg  
  inflating: train/ad/ad_train_24.jpg  
  inflating: train/ad/ad_train_25.jpg  
  inflating: train/ad/ad_train_26.jpg  
  inflating: train/ad/ad_train_27.jpg  
  inflating: train/ad/ad_train_28.jpg  
  inflating: train/ad/ad_train_29.jpg  
  inflating: train/ad/ad_train_3.jpg  
  inflating: train/ad/ad_train_30.jpg  
  inflating: train/ad/ad_train_31.jpg  
  inflating: train/ad/ad_train_32.jpg  
  inflating: train/ad/ad_train_33.jpg  
  inflating: train/ad/ad_train_34.jpg  
  inflating: train/ad/ad_train_35.jpg  
  inflating: train/ad/ad_train_36.jpg  
  inflating: train/ad/ad_train_37.jpg  
  inflating: train/ad/ad_train_38.jpg  
  inflating: train/ad/ad_train_39.jpg  
  inflating: train/ad/ad_train_4.jpg  
  inflating: train/ad/ad_train_40.jpg  
  inflating: train/ad/ad_train_41.jpg  
  inflating: train/ad/ad_train_42.jpg  
  inflating: train/ad/ad_train_43.jpg  
  inflating: train/ad/ad_train_44.jpg  
  inflating: train/ad/ad_train_45.jpg  
  inflating: train/ad/ad_train_46.jpg  
  inflating: train/ad/ad_train_47.jpg  
  inflating: train/ad/ad_train_48.jpg  
  inflating: train/ad/ad_train_49.jpg  
  inflating: train/ad/ad_train_5.jpg  
  inflating: train/ad/ad_train_50.jpg  
  inflating: train/ad/ad_train_51.jpg  
  inflating: train/ad/ad_train_52.jpg  
  inflating: train/ad/ad_train_53.jpg  
  inflating: train/ad/ad_train_54.jpg  
  inflating: train/ad/ad_train_55.jpg  
  inflating: train/ad/ad_train_56.jpg  
  inflating: train/ad/ad_train_57.jpg  
  inflating: train/ad/ad_train_58.jpg  
  inflating: train/ad/ad_train_59.jpg  
  inflating: train/ad/ad_train_6.jpg  
  inflating: train/ad/ad_train_60.jpg  
  inflating: train/ad/ad_train_61.jpg  
  inflating: train/ad/ad_train_62.jpg  
  inflating: train/ad/ad_train_63.jpg  
  inflating: train/ad/ad_train_64.jpg  
  inflating: train/ad/ad_train_65.jpg  
  inflating: train/ad/ad_train_66.jpg  
  inflating: train/ad/ad_train_67.jpg  
  inflating: train/ad/ad_train_68.jpg  
  inflating: train/ad/ad_train_69.jpg  
  inflating: train/ad/ad_train_7.jpg  
  inflating: train/ad/ad_train_70.jpg  
  inflating: train/ad/ad_train_71.jpg  
  inflating: train/ad/ad_train_72.jpg  
  inflating: train/ad/ad_train_73.jpg  
  inflating: train/ad/ad_train_74.jpg  
  inflating: train/ad/ad_train_75.jpg  
  inflating: train/ad/ad_train_76.jpg  
  inflating: train/ad/ad_train_77.jpg  
  inflating: train/ad/ad_train_78.jpg  
  inflating: train/ad/ad_train_79.jpg  
  inflating: train/ad/ad_train_8.jpg  
  inflating: train/ad/ad_train_80.jpg  
  inflating: train/ad/ad_train_9.jpg  
   creating: train/normal/
  inflating: train/normal/normal_train_1.jpg  
  inflating: train/normal/normal_train_10.jpg  
  inflating: train/normal/normal_train_11.jpg  
  inflating: train/normal/normal_train_12.jpg  
  inflating: train/normal/normal_train_13.jpg  
  inflating: train/normal/normal_train_14.jpg  
  inflating: train/normal/normal_train_15.jpg  
  inflating: train/normal/normal_train_16.jpg  
  inflating: train/normal/normal_train_17.jpg  
  inflating: train/normal/normal_train_18.jpg  
  inflating: train/normal/normal_train_19.jpg  
  inflating: train/normal/normal_train_2.jpg  
  inflating: train/normal/normal_train_20.jpg  
  inflating: train/normal/normal_train_21.jpg  
  inflating: train/normal/normal_train_22.jpg  
  inflating: train/normal/normal_train_23.jpg  
  inflating: train/normal/normal_train_24.jpg  
  inflating: train/normal/normal_train_25.jpg  
  inflating: train/normal/normal_train_26.jpg  
  inflating: train/normal/normal_train_27.jpg  
  inflating: train/normal/normal_train_28.jpg  
  inflating: train/normal/normal_train_29.jpg  
  inflating: train/normal/normal_train_3.jpg  
  inflating: train/normal/normal_train_30.jpg  
  inflating: train/normal/normal_train_31.jpg  
  inflating: train/normal/normal_train_32.jpg  
  inflating: train/normal/normal_train_33.jpg  
  inflating: train/normal/normal_train_34.jpg  
  inflating: train/normal/normal_train_35.jpg  
  inflating: train/normal/normal_train_36.jpg  
  inflating: train/normal/normal_train_37.jpg  
  inflating: train/normal/normal_train_38.jpg  
  inflating: train/normal/normal_train_39.jpg  
  inflating: train/normal/normal_train_4.jpg  
  inflating: train/normal/normal_train_40.jpg  
  inflating: train/normal/normal_train_41.jpg  
  inflating: train/normal/normal_train_42.jpg  
  inflating: train/normal/normal_train_43.jpg  
  inflating: train/normal/normal_train_44.jpg  
  inflating: train/normal/normal_train_45.jpg  
  inflating: train/normal/normal_train_46.jpg  
  inflating: train/normal/normal_train_47.jpg  
  inflating: train/normal/normal_train_48.jpg  
  inflating: train/normal/normal_train_49.jpg  
  inflating: train/normal/normal_train_5.jpg  
  inflating: train/normal/normal_train_50.jpg  
  inflating: train/normal/normal_train_51.jpg  
  inflating: train/normal/normal_train_52.jpg  
  inflating: train/normal/normal_train_53.jpg  
  inflating: train/normal/normal_train_54.jpg  
  inflating: train/normal/normal_train_55.jpg  
  inflating: train/normal/normal_train_56.jpg  
  inflating: train/normal/normal_train_57.jpg  
  inflating: train/normal/normal_train_58.jpg  
  inflating: train/normal/normal_train_59.jpg  
  inflating: train/normal/normal_train_6.jpg  
  inflating: train/normal/normal_train_60.jpg  
  inflating: train/normal/normal_train_61.jpg  
  inflating: train/normal/normal_train_62.jpg  
  inflating: train/normal/normal_train_63.jpg  
  inflating: train/normal/normal_train_64.jpg  
  inflating: train/normal/normal_train_65.jpg  
  inflating: train/normal/normal_train_66.jpg  
  inflating: train/normal/normal_train_67.jpg  
  inflating: train/normal/normal_train_68.jpg  
  inflating: train/normal/normal_train_69.jpg  
  inflating: train/normal/normal_train_7.jpg  
  inflating: train/normal/normal_train_70.jpg  
  inflating: train/normal/normal_train_71.jpg  
  inflating: train/normal/normal_train_72.jpg  
  inflating: train/normal/normal_train_73.jpg  
  inflating: train/normal/normal_train_74.jpg  
  inflating: train/normal/normal_train_75.jpg  
  inflating: train/normal/normal_train_76.jpg  
  inflating: train/normal/normal_train_77.jpg  
  inflating: train/normal/normal_train_78.jpg  
  inflating: train/normal/normal_train_79.jpg  
  inflating: train/normal/normal_train_8.jpg  
  inflating: train/normal/normal_train_80.jpg  
  inflating: train/normal/normal_train_9.jpg  
/////////////////////////////////////////
import tensorflow as tf
import numpy as np
import matplotlib.pyplot as plt

from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Activation, Dropout, Flatten, Dense, Conv2D, MaxPooling2D
from tensorflow.keras.preprocessing.image import ImageDataGenerator
from tensorflow.keras import optimizers, initializers, regularizers, metrics

np.random.seed(3)
tf.random.set_seed(3)

train_datagen = ImageDataGenerator(rescale=1./255,
                                  horizontal_flip=True,     #수평 대칭 이미지를 50% 확률로 만들어 추가합니다.
                                  width_shift_range=0.1,  #전체 크기의 10% 범위에서 좌우로 이동합니다.
                                  height_shift_range=0.1, #마찬가지로 위, 아래로 이동합니다.                                
                                  fill_mode='nearest') 

train_generator = train_datagen.flow_from_directory(
       'train',   #학습셋이 있는 폴더의 위치입니다.
       target_size=(150, 150),
       batch_size=5,
       class_mode='binary')

#테스트 셋은 이미지 부풀리기 과정을 진행하지 않습니다.
test_datagen = ImageDataGenerator(rescale=1./255)  

test_generator = test_datagen.flow_from_directory(
       'test',   #테스트셋이 있는 폴더의 위치입니다.
       target_size=(150, 150),
       batch_size=5,
       class_mode='binary')


# 앞서 배운 CNN 모델을 만들어 적용
model = Sequential()
model.add(Conv2D(32, (3, 3), input_shape=(150,150,3)))
model.add(Activation('relu'))
model.add(MaxPooling2D(pool_size=(2, 2)))

model.add(Conv2D(32, (3, 3)))
model.add(Activation('relu'))
model.add(MaxPooling2D(pool_size=(2, 2)))

model.add(Conv2D(64, (3, 3)))
model.add(Activation('relu'))
model.add(MaxPooling2D(pool_size=(2, 2)))

model.add(Flatten())
model.add(Dense(64))
model.add(Activation('relu'))
model.add(Dropout(0.5))
model.add(Dense(2))
model.add(Activation('softmax'))

#모델을 컴파일 
model.compile(loss='sparse_categorical_crossentropy', optimizer=optimizers.Adam(learning_rate=0.0002), metrics=['accuracy'])

#모델을 실행
history = model.fit_generator(
       train_generator,
       steps_per_epoch=30,  #적절한 값으로 조절합니다.
       epochs=100,   #적절한 값으로 조절합니다.
       validation_data=test_generator,
       validation_steps=10)

#결과를 그래프로 표현
acc= history.history['accuracy']
val_acc= history.history['val_accuracy']
y_vloss = history.history['val_loss']
y_loss = history.history['loss']

x_len = np.arange(len(y_loss))  
plt.plot(x_len, acc, marker='.', c="red", label='Trainset_acc')
plt.plot(x_len, val_acc, marker='.', c="lightcoral", label='Testset_acc')
plt.plot(x_len, y_vloss, marker='.', c="cornflowerblue", label='Testset_loss')
plt.plot(x_len, y_loss, marker='.', c="blue", label='Trainset_loss')

plt.legend(loc='upper right') 
plt.grid()
plt.xlabel('epoch')
plt.ylabel('loss/acc')
plt.show()

Found 160 images belonging to 2 classes.
Found 120 images belonging to 2 classes.
/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/training.py:1844: UserWarning: `Model.fit_generator` is deprecated and will be removed in a future version. Please use `Model.fit`, which supports generators.
  warnings.warn('`Model.fit_generator` is deprecated and '
Epoch 1/100
30/30 [==============================] - 6s 189ms/step - loss: 0.7027 - accuracy: 0.4541 - val_loss: 0.6884 - val_accuracy: 0.4800
Epoch 2/100
30/30 [==============================] - 5s 173ms/step - loss: 0.6942 - accuracy: 0.5249 - val_loss: 0.6713 - val_accuracy: 0.6000
Epoch 3/100
30/30 [==============================] - 5s 175ms/step - loss: 0.6887 - accuracy: 0.5556 - val_loss: 0.6913 - val_accuracy: 0.4400
Epoch 4/100
30/30 [==============================] - 5s 174ms/step - loss: 0.6796 - accuracy: 0.5413 - val_loss: 0.6829 - val_accuracy: 0.4400
Epoch 5/100
30/30 [==============================] - 5s 175ms/step - loss: 0.6819 - accuracy: 0.6010 - val_loss: 0.6443 - val_accuracy: 0.6200
Epoch 6/100
30/30 [==============================] - 5s 174ms/step - loss: 0.6385 - accuracy: 0.7463 - val_loss: 0.6209 - val_accuracy: 0.5600
Epoch 7/100
30/30 [==============================] - 5s 174ms/step - loss: 0.6400 - accuracy: 0.6036 - val_loss: 0.6341 - val_accuracy: 0.5600
Epoch 8/100
30/30 [==============================] - 5s 174ms/step - loss: 0.6040 - accuracy: 0.7243 - val_loss: 0.5464 - val_accuracy: 0.7600
Epoch 9/100
30/30 [==============================] - 5s 173ms/step - loss: 0.5003 - accuracy: 0.7431 - val_loss: 0.5417 - val_accuracy: 0.8200
Epoch 10/100
30/30 [==============================] - 5s 174ms/step - loss: 0.5154 - accuracy: 0.8531 - val_loss: 0.5063 - val_accuracy: 0.7400
Epoch 11/100
30/30 [==============================] - 5s 174ms/step - loss: 0.4070 - accuracy: 0.8433 - val_loss: 0.5051 - val_accuracy: 0.7000
Epoch 12/100
30/30 [==============================] - 5s 176ms/step - loss: 0.4094 - accuracy: 0.8218 - val_loss: 0.4231 - val_accuracy: 0.8200
Epoch 13/100
30/30 [==============================] - 5s 174ms/step - loss: 0.3251 - accuracy: 0.8996 - val_loss: 0.2191 - val_accuracy: 0.9400
Epoch 14/100
30/30 [==============================] - 5s 174ms/step - loss: 0.3379 - accuracy: 0.8770 - val_loss: 0.1785 - val_accuracy: 0.9400
Epoch 15/100
30/30 [==============================] - 5s 174ms/step - loss: 0.2857 - accuracy: 0.8996 - val_loss: 0.2410 - val_accuracy: 0.9400
Epoch 16/100
30/30 [==============================] - 5s 175ms/step - loss: 0.2885 - accuracy: 0.8510 - val_loss: 0.2083 - val_accuracy: 0.9200
Epoch 17/100
30/30 [==============================] - 5s 176ms/step - loss: 0.2115 - accuracy: 0.8990 - val_loss: 0.2042 - val_accuracy: 0.9400
Epoch 18/100
30/30 [==============================] - 5s 176ms/step - loss: 0.1820 - accuracy: 0.9520 - val_loss: 0.1345 - val_accuracy: 0.9800
Epoch 19/100
30/30 [==============================] - 5s 176ms/step - loss: 0.1485 - accuracy: 0.9467 - val_loss: 0.1299 - val_accuracy: 0.9400
Epoch 20/100
30/30 [==============================] - 5s 175ms/step - loss: 0.1547 - accuracy: 0.9630 - val_loss: 0.1358 - val_accuracy: 0.9200
Epoch 21/100
30/30 [==============================] - 5s 174ms/step - loss: 0.1113 - accuracy: 0.9637 - val_loss: 0.0325 - val_accuracy: 1.0000
Epoch 22/100
30/30 [==============================] - 5s 175ms/step - loss: 0.1462 - accuracy: 0.9629 - val_loss: 0.1023 - val_accuracy: 0.9600
Epoch 23/100
30/30 [==============================] - 5s 177ms/step - loss: 0.1176 - accuracy: 0.9751 - val_loss: 0.0617 - val_accuracy: 1.0000
Epoch 24/100
30/30 [==============================] - 5s 174ms/step - loss: 0.1383 - accuracy: 0.9415 - val_loss: 0.1021 - val_accuracy: 0.9600
Epoch 25/100
30/30 [==============================] - 5s 176ms/step - loss: 0.1306 - accuracy: 0.9520 - val_loss: 0.0876 - val_accuracy: 0.9600
Epoch 26/100
30/30 [==============================] - 5s 175ms/step - loss: 0.1022 - accuracy: 0.9623 - val_loss: 0.0857 - val_accuracy: 0.9800
Epoch 27/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0928 - accuracy: 0.9591 - val_loss: 0.0789 - val_accuracy: 0.9800
Epoch 28/100
30/30 [==============================] - 5s 176ms/step - loss: 0.1148 - accuracy: 0.9741 - val_loss: 0.0412 - val_accuracy: 1.0000
Epoch 29/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0727 - accuracy: 0.9788 - val_loss: 0.0620 - val_accuracy: 0.9800
Epoch 30/100
30/30 [==============================] - 5s 175ms/step - loss: 0.1672 - accuracy: 0.9191 - val_loss: 0.0588 - val_accuracy: 0.9800
Epoch 31/100
30/30 [==============================] - 5s 174ms/step - loss: 0.1249 - accuracy: 0.9576 - val_loss: 0.0351 - val_accuracy: 0.9800
Epoch 32/100
30/30 [==============================] - 5s 175ms/step - loss: 0.1073 - accuracy: 0.9665 - val_loss: 0.2542 - val_accuracy: 0.9000
Epoch 33/100
30/30 [==============================] - 5s 175ms/step - loss: 0.1718 - accuracy: 0.9355 - val_loss: 0.0863 - val_accuracy: 0.9600
Epoch 34/100
30/30 [==============================] - 5s 176ms/step - loss: 0.1065 - accuracy: 0.9638 - val_loss: 0.0799 - val_accuracy: 0.9800
Epoch 35/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0785 - accuracy: 0.9764 - val_loss: 0.0543 - val_accuracy: 0.9800
Epoch 36/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0874 - accuracy: 0.9813 - val_loss: 0.1006 - val_accuracy: 0.9600
Epoch 37/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0584 - accuracy: 0.9853 - val_loss: 0.1119 - val_accuracy: 0.9600
Epoch 38/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0596 - accuracy: 0.9908 - val_loss: 0.0645 - val_accuracy: 0.9800
Epoch 39/100
30/30 [==============================] - 5s 175ms/step - loss: 0.1079 - accuracy: 0.9531 - val_loss: 0.0556 - val_accuracy: 0.9800
Epoch 40/100
30/30 [==============================] - 5s 174ms/step - loss: 0.1103 - accuracy: 0.9499 - val_loss: 0.0444 - val_accuracy: 1.0000
Epoch 41/100
30/30 [==============================] - 5s 173ms/step - loss: 0.0645 - accuracy: 0.9809 - val_loss: 0.0658 - val_accuracy: 0.9800
Epoch 42/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0677 - accuracy: 0.9772 - val_loss: 0.0248 - val_accuracy: 1.0000
Epoch 43/100
30/30 [==============================] - 5s 173ms/step - loss: 0.0796 - accuracy: 0.9754 - val_loss: 0.1751 - val_accuracy: 0.9200
Epoch 44/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0756 - accuracy: 0.9700 - val_loss: 0.0807 - val_accuracy: 0.9800
Epoch 45/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0478 - accuracy: 0.9763 - val_loss: 0.1054 - val_accuracy: 0.9400
Epoch 46/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0811 - accuracy: 0.9544 - val_loss: 0.0508 - val_accuracy: 0.9800
Epoch 47/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0497 - accuracy: 0.9940 - val_loss: 0.1064 - val_accuracy: 0.9600
Epoch 48/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0458 - accuracy: 0.9929 - val_loss: 0.1044 - val_accuracy: 0.9400
Epoch 49/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0359 - accuracy: 0.9954 - val_loss: 0.0435 - val_accuracy: 0.9800
Epoch 50/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0564 - accuracy: 0.9837 - val_loss: 0.0099 - val_accuracy: 1.0000
Epoch 51/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0372 - accuracy: 0.9881 - val_loss: 0.0058 - val_accuracy: 1.0000
Epoch 52/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0981 - accuracy: 0.9688 - val_loss: 0.0052 - val_accuracy: 1.0000
Epoch 53/100
30/30 [==============================] - 5s 173ms/step - loss: 0.0651 - accuracy: 0.9808 - val_loss: 0.0650 - val_accuracy: 0.9800
Epoch 54/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0694 - accuracy: 0.9808 - val_loss: 0.1010 - val_accuracy: 0.9600
Epoch 55/100
30/30 [==============================] - 5s 174ms/step - loss: 0.1496 - accuracy: 0.9715 - val_loss: 0.0620 - val_accuracy: 0.9800
Epoch 56/100
30/30 [==============================] - 5s 174ms/step - loss: 0.1270 - accuracy: 0.9575 - val_loss: 0.0551 - val_accuracy: 1.0000
Epoch 57/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0449 - accuracy: 0.9876 - val_loss: 0.0727 - val_accuracy: 0.9600
Epoch 58/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0535 - accuracy: 0.9901 - val_loss: 0.0564 - val_accuracy: 0.9800
Epoch 59/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0354 - accuracy: 0.9919 - val_loss: 0.0828 - val_accuracy: 0.9400
Epoch 60/100
30/30 [==============================] - 5s 173ms/step - loss: 0.0639 - accuracy: 0.9745 - val_loss: 0.1349 - val_accuracy: 0.9400
Epoch 61/100
30/30 [==============================] - 5s 174ms/step - loss: 0.1599 - accuracy: 0.9398 - val_loss: 0.1743 - val_accuracy: 0.9400
Epoch 62/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0312 - accuracy: 0.9940 - val_loss: 0.0734 - val_accuracy: 0.9600
Epoch 63/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0241 - accuracy: 0.9978 - val_loss: 0.0372 - val_accuracy: 0.9800
Epoch 64/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0632 - accuracy: 0.9895 - val_loss: 0.0148 - val_accuracy: 1.0000
Epoch 65/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0559 - accuracy: 0.9870 - val_loss: 0.0367 - val_accuracy: 0.9800
Epoch 66/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0285 - accuracy: 0.9874 - val_loss: 0.0386 - val_accuracy: 0.9800
Epoch 67/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0285 - accuracy: 1.0000 - val_loss: 0.0101 - val_accuracy: 1.0000
Epoch 68/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0973 - accuracy: 0.9727 - val_loss: 0.0100 - val_accuracy: 1.0000
Epoch 69/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0849 - accuracy: 0.9885 - val_loss: 0.0382 - val_accuracy: 1.0000
Epoch 70/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0995 - accuracy: 0.9642 - val_loss: 0.0726 - val_accuracy: 0.9600
Epoch 71/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0536 - accuracy: 0.9899 - val_loss: 0.0282 - val_accuracy: 1.0000
Epoch 72/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0645 - accuracy: 0.9721 - val_loss: 0.0388 - val_accuracy: 0.9800
Epoch 73/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0576 - accuracy: 0.9823 - val_loss: 0.0575 - val_accuracy: 0.9600
Epoch 74/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0581 - accuracy: 0.9853 - val_loss: 0.0102 - val_accuracy: 1.0000
Epoch 75/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0497 - accuracy: 0.9737 - val_loss: 0.0204 - val_accuracy: 1.0000
Epoch 76/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0603 - accuracy: 0.9580 - val_loss: 0.0608 - val_accuracy: 0.9800
Epoch 77/100
30/30 [==============================] - 5s 173ms/step - loss: 0.0420 - accuracy: 0.9820 - val_loss: 0.1525 - val_accuracy: 0.9000
Epoch 78/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0302 - accuracy: 0.9989 - val_loss: 0.0701 - val_accuracy: 0.9800
Epoch 79/100
30/30 [==============================] - 5s 174ms/step - loss: 0.1460 - accuracy: 0.9692 - val_loss: 0.0229 - val_accuracy: 1.0000
Epoch 80/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0402 - accuracy: 0.9836 - val_loss: 0.0901 - val_accuracy: 0.9600
Epoch 81/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0414 - accuracy: 0.9738 - val_loss: 0.0263 - val_accuracy: 0.9800
Epoch 82/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0732 - accuracy: 0.9735 - val_loss: 0.0390 - val_accuracy: 1.0000
Epoch 83/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0546 - accuracy: 0.9858 - val_loss: 0.0416 - val_accuracy: 0.9800
Epoch 84/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0439 - accuracy: 0.9923 - val_loss: 0.0174 - val_accuracy: 1.0000
Epoch 85/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0311 - accuracy: 0.9847 - val_loss: 0.0095 - val_accuracy: 1.0000
Epoch 86/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0375 - accuracy: 0.9875 - val_loss: 0.0690 - val_accuracy: 0.9800
Epoch 87/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0086 - accuracy: 1.0000 - val_loss: 0.0509 - val_accuracy: 0.9800
Epoch 88/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0359 - accuracy: 0.9806 - val_loss: 0.0125 - val_accuracy: 1.0000
Epoch 89/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0511 - accuracy: 0.9726 - val_loss: 0.0139 - val_accuracy: 1.0000
Epoch 90/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0219 - accuracy: 0.9940 - val_loss: 0.0014 - val_accuracy: 1.0000
Epoch 91/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0572 - accuracy: 0.9794 - val_loss: 0.0274 - val_accuracy: 0.9800
Epoch 92/100
30/30 [==============================] - 5s 174ms/step - loss: 0.0376 - accuracy: 0.9755 - val_loss: 0.1142 - val_accuracy: 0.9400
Epoch 93/100
30/30 [==============================] - 6s 204ms/step - loss: 0.0404 - accuracy: 0.9805 - val_loss: 0.0053 - val_accuracy: 1.0000
Epoch 94/100
30/30 [==============================] - 6s 203ms/step - loss: 0.0139 - accuracy: 0.9946 - val_loss: 0.0203 - val_accuracy: 1.0000
Epoch 95/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0086 - accuracy: 0.9950 - val_loss: 0.0286 - val_accuracy: 1.0000
Epoch 96/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0162 - accuracy: 1.0000 - val_loss: 0.0704 - val_accuracy: 0.9800
Epoch 97/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0446 - accuracy: 0.9644 - val_loss: 0.0560 - val_accuracy: 0.9800
Epoch 98/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0425 - accuracy: 0.9729 - val_loss: 0.1210 - val_accuracy: 0.9800
Epoch 99/100
30/30 [==============================] - 5s 175ms/step - loss: 0.0542 - accuracy: 0.9704 - val_loss: 0.0918 - val_accuracy: 0.9800
Epoch 100/100
30/30 [==============================] - 5s 176ms/step - loss: 0.0417 - accuracy: 0.9935 - val_loss: 0.0546 - val_accuracy: 0.9800


